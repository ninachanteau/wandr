<div class="new-container">
<div class="container">

  <div class="header">
    <div class="title text-center"> <h2><%= trip.name  %>  ...  <i class="fa fa-plane title-icon"></i></h2>
    </div>
  </div>

  <div class="transportations-container">
    <div class="transportations-ctn">
      <div class="user-transportations transportations-card">

        <!-- Button trigger modal -->
        <div type="button" data-toggle="modal" data-target="#myModal">
          <i class="fa fa-plus-circle plus-btn"></i>
        </div>

        <!-- Modal -->
        <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title text-center" id="myModalLabel">Add a transportation</h4>
              </div>
              <div class="modal-body">
                <div id="trip_dates" data-trip-dates="<%= trip_dates.to_json %>"></div>
                <%= simple_form_for [trip, transportation] do |f| %>
                <div class="row">
                  <div class="col-xs-6">
                  <%= f.input :departure_port, placeholder: "From", label: false, class: 'form-control' %>
                  </div>
                  <div class="col-xs-6">
                  <%= f.input :arrival_port, placeholder: "To", label: false, class: 'form-control' %>
                  </div>
                </div>
                <div class="row">
                  <div class="col-xs-6">
                  <%= f.input :departure_date, as: :string, required: false, input_html: { class: "datepicker" }, class: 'form-control', placeholder: "Departure Date", label: false, data_altinput: true, data_enabletime: true %>
                  </div>
                  <div class="col-xs-6">
                  <%= f.input :arrival_date, as: :string, required: false, input_html: { class: "datepicker" }, class: 'form-control', placeholder: "Arrival Date", label: false, data_altinput: true, data_enabletime: true %>
                  </div>
                </div>
                  <%= f.input :price_per_person, placeholder: "Price per person", label: false, class: 'form-control' %>
                  <%= f.input :reference_number, placeholder: "Booking reference", label: false, class: 'form-control' %>
                  <%= f.input :status, collection: ["Wishlist", "Booked"], default: "Wishlist", class: 'form-control', label: false %>
              </div>
                <!-- Add participants -->
                <p>Who will be attending?</p>
                  <%= form_tag(trip_transportations_path, method: :post) %>
                  <% trip.participations.each do |part| %>
                      <%= check_box_tag part.pseudo%>
                      <%= h part.pseudo -%>
                      <br>
                    <% end %>
                    <br>
                <%= f.submit "Save", class: 'btn btn-info', style: 'width: 100%' %>
              <% end %>
            </div>
          </div>
        </div>



          <div class="transportations-title">
            <h4 class="transpo-title">Upcoming travel plans</h4>
          </div>
          <div class="cards-ctn">
            <% if participation %>
              <% my_transportations.each do |transpo| %>
                <% if transpo.participation.user_id == current_user.id %>
                  <div class="transportation-card">
                    <div class="details-card">
                      <div class="departure"><p><strong>FROM:</strong> <%= transpo.departure_port%></p></div>
                      <div class="date-time">
                        <p ><%= transpo.departure_date.strftime("%b %d, %Y") %> at <%= transpo.departure_date.strftime("%H:%M") %></p>
                      </div>
                      <div class="arrival"><p><strong>TO:</strong> <%= transpo.arrival_port%></p></div>
                      <div class="date-time">
                        <p ><%= transpo.arrival_date.strftime("%b %d, %Y") %> at <%= transpo.arrival_date.strftime("%H:%M") %></p>
                      </div>
                      <div class="price-status"><p class="ticket-price"><%= number_with_precision(transpo.price_per_person, precision: 2)%>€</p></div>
                    </div>
                    <div class="reference-card"><p class="reference text-center"><%= transpo.reference_number%></p></div>
                    <div class="transpo-status">
                          <div class="btn-group">
                            <button type="button" class="btn btn-light dropdown-toggle" style="background-color: transparent" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                              <% if transpo.status == "Wishlist" %>
                                <%= render 'shared/wishlist-icon' %>
                              <% else %>
                                <%= render 'shared/booked-icon' %>
                              <% end %>
                            </button>
                            <div class="dropdown-menu">
                              <% if transpo.status == "Booked" %>
                                <%= link_to trip_transportation_path(trip, transpo, status: "Wishlist"), method: :patch, class: "dropdown-item status-dropdown-item" do %>
                                  <span>
                                    <%= render 'shared/wishlist-icon'  %>
                                    Wishlist
                                  </span>
                                <% end %>
                              <% elsif transpo.status == "Wishlist" %>
                                <%= link_to trip_transportation_path(trip, transpo, status: "Booked"), method: :patch, class: "dropdown-item status-dropdown-item" do %>
                                  <span>
                                    <%= render 'shared/booked-icon'  %>
                                    Booked
                                  </span>
                                <% end %>
                              <% end %>
                              <div class="dropdown-divider"></div>
                              <%= link_to trip_transportation_path(trip, transpo), method: :delete, class: "dropdown-item status-dropdown-item" do %>
                                  <span>
                                    <%= render 'shared/delete-icon'  %>
                                    Delete
                                  </span>
                                <% end %>
                            </div>
                          </div>
                    </div>
                    <div><%= cl_image_tag avatar, class: "avatar transpo-avatar", crop: :fill%></div>
                  </div>
                <% end %>
              <% end %>
            <% else %>
              <p>No transportation currently saved for you</p>
            <% end %>
          </div>
      </div>

      <div class="other-transportations transportations-card">
        <div>
          <%= link_to do %>
            <i class="fa fa-plus-circle plus-btn"></i>
          <% end %>
        </div>
        <div class="transportations-title">
          <h4 class="transpo-title">Other travel plans</h4>
        </div>
        <div class="cards-ctn">
          <% transportations.each do |transpo| %>
            <% if transpo.participation.user != current_user %>

              <div class="transportation-card">
                <div class="details-card">
                  <div class="departure"><p><strong>FROM:</strong> <%= transpo.departure_port%></p></div>
                  <div class="date-time">
                    <p ><%= transpo.departure_date.strftime("%b %d, %Y") %> at <%= transpo.departure_date.strftime("%H:%M") %></p>
                  </div>
                  <div class="arrival"><p><strong>TO:</strong> <%= transpo.arrival_port%></p></div>
                  <div class="date-time">
                    <p ><%= transpo.arrival_date.strftime("%b %d, %Y") %> at <%= transpo.arrival_date.strftime("%H:%M") %></p>
                  </div>
                  <div class="price-status"><p class="ticket-price"><%= number_with_precision(transpo.price_per_person, precision: 2)%>€</p>
                  </div>
                </div>
                <div class="reference-card"><p class="reference text-center">
                  <%= transpo.reference_number%></p>
                </div>
                <div class="transpo-status">
                    <div class="btn-group">
                      <button type="button" class="btn btn-light dropdown-toggle" style="background-color: transparent" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                          <% if transpo.status == "Wishlist" %>
                            <%= render 'shared/wishlist-icon' %>
                          <% else %>
                            <%= render 'shared/booked-icon' %>
                          <% end %>
                      </button>
                        <div class="dropdown-menu">
                          <% if transpo.status == "Booked" %>
                            <%= link_to trip_transportation_path(trip, transpo, status: "Wishlist"), method: :patch, class: "dropdown-item status-dropdown-item" do %>
                              <span>
                                <%= render 'shared/wishlist-icon'  %>
                                Wishlist
                              </span>
                            <% end %>
                          <% elsif transpo.status == "Wishlist" %>
                            <%= link_to trip_transportation_path(trip, transpo, status: "Booked"), method: :patch, class: "dropdown-item status-dropdown-item" do %>
                              <span>
                                <%= render 'shared/booked-icon'  %>
                                Booked
                              </span>
                            <% end %>
                          <% end %>
                          <div class="dropdown-divider"></div>
                          <%= link_to trip_transportation_path(trip, transpo), method: :delete, class: "dropdown-item status-dropdown-item" do %>
                              <span>
                                <%= render 'shared/delete-icon'  %>
                                Delete
                              </span>
                            <% end %>
                        </div>
                    </div>
                </div>
                <% if transpo.participation.user %>
                  <%= cl_image_tag transpo.participation.user.avatar, class: "avatar transpo-avatar", crop: :fill%>
                <% else %>
                  <%= cl_image_tag "default-user.png", class: "avatar transpo-avatar", crop: :fill%>
                <% end %>
              </div>
            <% end %>
          <% end %>
        </div>




</div>
</div>




